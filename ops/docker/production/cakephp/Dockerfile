FROM hxhroniegss/cakephp3
LABEL maintainer="Ronie Vincent Horca <ronievincent.gss@gmail.com>"
# Changed directory to cakephp
WORKDIR /var/www/html/src/cakephp

USER root:root
# Set all necessary variables
ARG CAKE_KEY
ARG FB_APP_ID
ARG FB_APP_SECRET
ARG GOOGLE_CLIENT_ID
ARG TWITTER_API_KEY
ARG TWITTER_API_SECRET
ARG FREEE_API_KEY
ARG FREEE_API_SECRET
ARG MFCLOUD_API_KEY
ARG MFCLOUD_API_SECRET
ARG MISOCA_API_KEY
ARG MISOCA_API_SECRET
ARG MONEYTREE_API_KEY
ARG MONEYTREE_API_SECRET
ARG TWILIO_SID
ARG TWILIO_TOKEN
ARG TWILIO_VOICE_MFA_URL
ARG SEND_GRID_API_KEY
ARG COMPANY_NUMBER_API_KEY
ARG BOARD_API_KEY
ARG BOARD_API_SECRET
ARG RECAPTCHA_SITE_KEY
ARG RECAPTCHA_SECRET
ARG URL

ENV PROJECT_NAME=frnc-frontend \
	SERVICE_URL=$URL \
	SERVICE_SSL_URL=$URL \
	CAKE_KEY=$CAKE_KEY \
    DEBUG_LEVEL=false \
    FB_APP_ID=$FB_APP_ID \
	FB_APP_SECRET=$FB_APP_SECRET \
	GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID \
	TWITTER_API_KEY=$TWITTER_API_KEY \
	TWITTER_API_SECRET=$TWITTER_API_SECRET \
	FREEE_API_KEY=$FREEE_API_KEY \
	FREEE_API_SECRET=$FREEE_API_SECRET \
	MFCLOUD_API_KEY=$MFCLOUD_API_KEY \
	MFCLOUD_API_SECRET=$MFCLOUD_API_SECRET \
	MISOCA_API_KEY=$MISOCA_API_KEY \
	MISOCA_API_SECRET=$MISOCA_API_SECRET \
	MONEYTREE_API_KEY=$MONEYTREE_API_KEY \
	MONEYTREE_API_SECRET=$MONEYTREE_API_SECRET \
	TWILIO_SID=$TWILIO_SID \
	TWILIO_TOKEN=$TWILIO_TOKEN \
	TWILIO_VOICE_MFA_URL=$TWILIO_VOICE_MFA_URL \
	SEND_GRID_API_KEY=$SEND_GRID_API_KEY \
	COMPANY_NUMBER_API_KEY=$COMPANY_NUMBER_API_KEY \
	BOARD_API_KEY=$BOARD_API_KEY \
	BOARD_API_SECRET=$BOARD_API_SECRET \
	RECAPTCHA_SECRET=$RECAPTCHA_SECRET \
	RECAPTCHA_SITE_KEY=$RECAPTCHA_SITE_KEY

# Copy cakephp3 source code to /var/www/html/src/cakephp directory
COPY ./src /var/www/html/src
RUN composer install -o \
    && bin/cake plugin assets symlink

